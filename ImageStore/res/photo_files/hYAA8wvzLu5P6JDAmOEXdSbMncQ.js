window.jQuery&&window.bemhtml&&(BEM.DOM.decl({block:"direct-updater",modName:"use-tags",modVal:!0},{setTagsLoader:function(t){this._tagsLoader=t},hasTagsLoader:function(){return Boolean(this._getTagsLoader())},_getTagsLoader:function(){return this._tagsLoader},_getLoadingDirectParams:function(t){if(!this._getTagsLoader())return this.__base.apply(this,arguments);var e=$.Deferred(),r=this._getNearestImages(t.pos,t.count);if(!(r instanceof Array))return e.reject().promise();var a=(r=r.filter(this._noDirectData,this)).map(function(t){return this._getTagsLoader().get(t).then(function(e){return Object.assign({},t,{tags:e})})},this);return $.when.all(a)},_preloadDirect:function(t){if(!this._getTagsLoader())return this.__base.apply(this,arguments);this._getLoadingDirectParams(t).then(function(t){var e=this._prepareLoadingDirectParams(t);this._getDirectLoader().batchLoad(e)}.bind(this))}}),void 0===jQuery.when.all&&(jQuery.when.all=function(t){return $.Deferred(function(e){$.when.apply(jQuery,t).then(function(){e.resolveWith(this,[Array.prototype.slice.call(arguments)])},function(){e.rejectWith(this,[Array.prototype.slice.call(arguments)])})})}));